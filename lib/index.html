<!DOCTYPE html>
<html>
<head>
  <script src="jquery-2.1.1.js"></script>
  <script src="keymaster.js"></script>
  <script src="utils.js"></script>
  <script src="movingObject.js"></script>
  <script src="asteroid.js"></script>
  <script src="bullets.js"></script>
  <script src="ship.js"></script>
  <script src="game.js"></script>
  <script src="gameView.js"></script>
  <script src="mouse.js"></script>
  <script src="audioVisualizer.js"></script>

  <link rel="stylesheet" type="text/css" href="asteroids.css">

</head>
  <body>
    <main>
      <h1 class="title">Asteroids</h1>
      <h2 class="newGame">New Game</h2>
      <h2 class="setting">Settings</h2>
    </main>

    <canvas id="analyser_render"></canvas>

    <canvas id="game-canvas"></canvas>

    <div class="score">
      <ul>
        <li class="final-score"></li>
      </ul>
    </div>

    <h2 class="restart">Restart</h2>
    <h2 class="main-menu">Main Menu</h2>

    <script>
      var gameAudio = new Audio("music/test.mp3");
      var menuAudio = new Audio("music/menu.mp3")
        menuAudio.addEventListener('ended', function() {
          this.currentTime = 0;
          this.play();
        }, false);
        gameAudio.addEventListener('ended', function() {
          this.currentTime = 0;
          this.play();
        }, false);


      Asteroids.Music.visualize(menuAudio);
      menuAudio.oncanplaythrough = menuAudio.play();

      // misha mishenko - Vakning að elska
      // Misha Mishenko - Vor í mig

      $(".newGame").on("click", function () {
        window.canvasEl = document.getElementById("game-canvas");
        window.canvasHeight = canvasEl.height = window.innerHeight;
        window.canvasWidth = canvasEl.width = window.innerWidth;
        window.ctx = canvasEl.getContext("2d");
        if (typeof window.ast === "undefined") {
          window.ast = new Asteroids.GameView(ctx, canvasHeight, canvasWidth);
        }

        ast.game = new Asteroids.Game(canvasWidth, canvasHeight);
        ast.bindKeyHandlers();
        window.cancelAnimationFrame(requestID)
        $("canvas").toggleClass("playtime");
        $("main").toggleClass("playtime");

        menuAudio.pause();
        menuAudio.currentTime = 0;
        gameAudio.oncanplaythrough = gameAudio.play();
        ast.start();
      })
    </script>
  </body>
</html>